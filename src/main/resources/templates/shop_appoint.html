<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>美容美发协会</title>
    <link rel="stylesheet" type="text/css" href="../res/static/css/main.css">
    <link rel="stylesheet" type="text/css" href="../res/layui/css/layui.css">
    <script type="text/javascript" src="../res/layui/layui.js"></script>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <style>
    .layui-input {
      width: 250px;
    }

    }



    </style>
</head>
<body>

<div class="site-nav-bg">
    <div class="site-nav w1200">

        <div class="sn-quick-menu">
            <div class="login"><a href="shopres">商家入驻</a></div>
            <div class="login"><a href="shoplogin">商家登录</a></div>
            <div class="login"><a href="userres">用户注册</a></div>
            <div class="login"><a href="userlogin">用户登录</a></div>
            <div class="login"><a href="appointment">我的预约</a></div>
            <div class="login"><a href="admin">管理员</a></div>
        </div>
    </div>
</div>


<div class="header">
    <div class="headerLayout w1200">
        <div class="headerCon">
            <h1 class="mallLogo">
                <a href="#" title="美容美发协会">
                    <img src="../res/static/img/titlename.png">
                </a>
            </h1>
            <div class="mallSearch">
                <form action="" class="layui-form" novalidate>
                    <input type="text" name="title" required lay-verify="required" autocomplete="off"
                           class="layui-input" placeholder="请输入店铺名查找">
                    <button class="layui-btn" lay-submit lay-filter="formDemo">
                        <i class="layui-icon layui-icon-search"></i>
                    </button>
                    <input type="hidden" name="" value="">
                </form>
            </div>
        </div>
    </div>
</div>


<div class="content content-nav-base commodity-content">
    <div class="main-nav">
        <div class="inner-cont0">
            <div class="inner-cont1 w1200">
                <div class="inner-cont2">
                    <a href="index">潮流资讯</a>
                    <a href="shoplist" class="active">店铺浏览</a>
                    <a href="about">关于我们</a>
                </div>
            </div>
        </div>
    </div>
    <div class="commod-cont-wrap">
        <div class="commod-cont w1200 layui-clear">
            <div class="left-nav">
                <div class="title">分类</div>
                <div class="list-box">
                    <dl>
                        <dt><a onclick="test1()">美发套餐</a></dt>
                    </dl>
                    <dl>
                        <dt><a onclick="test2()">发型师</a></dt>
                    </dl>
                    <dl>
                        <dt><a onclick="test3()">店铺评论</a></dt>
                    </dl>
                    <dt><a o style="color:plum;">进行预约</a></dt>
                    </dl>
                    </dl>
                    <dt><a onclick="test4()">店铺信息</a></dt>
                    </dl>
                </div>
            </div>
            <div class="right-cont-wrap">
                <div class="right-cont">
                    <form class="layui-form" action="">
                        <div class="layui-inline">

                            <label class="layui-form-label">选择套餐</label>
                            <div class="layui-input-inline">
                                <select id="type" name="modules" lay-verify="required" lay-search="">
                                    <div th:each="types:${Types}">
                                        <option th:value="${types.type_id}"><span th:text="${types.type_name}"></span>
                                        </option>
                                    </div>
                                </select>

                            </div>
                        </div>
                        <div class="layui-inline">

                            <label class="layui-form-label">选择发型师</label>
                            <div class="layui-input-inline">
                                <select id="hairstylist" name="modules" lay-verify="required" lay-search="">
                                    <div th:each="hairstylist:${hairstylist}">
                                        <option th:value="${hairstylist.hairstylist_id}"><span
                                                th:text="${hairstylist.name}"></span></option>
                                    </div>
                                </select>

                            </div>
                        </div>
                        <div class="layui-inline">
                        <label class="layui-form-label">到店时间</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" id="time" placeholder="选择到店时间">
                        </div>
                        </div>
                        <a type="button" onclick="btn()" class="layui-btn layui-btn-normal"  >提交预约</a>
                    </form>
                </div>
            </div>

            <script>

            layui.use(['form', 'layedit', 'laydate'], function(){
  var form = layui.form
  ,layer = layui.layer
  ,layedit = layui.layedit
  ,laydate = layui.laydate;

    var laydate = layui.laydate;
            //日期时间选择器
            laydate.render({
              elem: '#time'
              , type: 'datetime'

            });


});


  layui.config({
    base: '../res/static/js/util/' //你存放新模块的目录，注意，不是layui的模块目录
  }).use(['mm','laypage','jquery'],function(){
      var laypage = layui.laypage,$ = layui.$,
     mm = layui.mm;
       laypage.render({
        elem: 'demo0'
        ,count: 100 //数据总数
      });


    $('.sort a').on('click',function(){
      $(this).addClass('active').siblings().removeClass('active');
    })
    $('.list-box dt').on('click',function(){
      if($(this).attr('off')){
        $(this).removeClass('active').siblings('dd').show()
        $(this).attr('off','')
      }else{
        $(this).addClass('active').siblings('dd').hide()
        $(this).attr('off',true)
      }
    })

});
        function getQueryVariable(variable)
{
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
               var pair = vars[i].split("=");
               if(pair[0] == variable){return pair[1];}
       }
       return(false);
}
        var a = getQueryVariable("id")

        function test1(){
			 window.location.href='http://localhost:8088/shop_hairstylist?id='+a
		}

		function test2(){
			 window.location.href='http://localhost:8088/shop_type?id='+a
		}

		function test3(){
			 window.location.href='http://localhost:8088/shop_comment?id='+a
		}

		function test4(){
			 window.location.href='http://localhost:8088/shop_info?id='+a
		}

		//提交预约
		function btn(){
		  var hairstylist_id = document.getElementById("hairstylist").value
		  var type_id = document.getElementById("type").value
		  var time = document.getElementById("time").value
		  var date = new Date(time);
		  var form = new FormData();
		  var user_id = getCookie("id");
          //添加参数bai
          form.append('shop_id', a);
          form.append('type_id', type_id);
          form.append('appoint_time', date);
          form.append('user_id', user_id);
          form.append('hairstylist_id', hairstylist_id);
          //使用xmlhttprequest发起请求du
          var xhr = new XMLHttpRequest();
          xhr.open('post', 'http://localhost:8088/shop_postappoint', true);
          xhr.onreadystatechange = function () {
            if (xhr.readyState == 4) {
              //成功
            }
          }
          var gnl = confirm("确定要提交?");
           if (gnl == true) {
          //执行请求
          xhr.send(form);

            }
           }


           //获取当前用户id
		 function getCookie(cookie_name) {

            var allcookies = document.cookie;

            var cookie_pos = allcookies.indexOf(cookie_name);   


            if (cookie_pos != -1) {

              cookie_pos += cookie_name.length + 1;     

              var cookie_end = allcookies.indexOf(";", cookie_pos);

              if (cookie_end == -1) {

                cookie_end = allcookies.length;

              }
              var value = unescape(allcookies.substring(cookie_pos, cookie_end)); 

            }
            return value;
          }








            </script>


</body>
</html>